<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.weaverloft.ganttchart.mapper.UsersMapper">
    <!-- 1. 회원가입 -->
    <insert id="createUsers" parameterType="com.weaverloft.ganttchart.dto.Users">
        insert into users(id,grade,password,name,photo,birth,gender,phone,address,email)
        values(#{id},#{grade},#{password},#{name},#{photo},#{birth},0,#{phone},#{address},#{email})
    </insert>
    <!--2. 내 정보 조회 -->
    <select id="findUsersById" parameterType="java.lang.String" resultType="com.weaverloft.ganttchart.dto.Users">
        select * from USERS where id = #{id}
    </select>
    <!--3. 정보 수정 -->
    <update id="updateUsers" parameterType="com.weaverloft.ganttchart.dto.Users">
        update USERS
        set name=#{name}, PHOTO=#{photo}, BIRTH=#{birth}, GENDER=#{gender}, phone=#{phone}, ADDRESS=#{address}, EMAIL=#{email}
        where id=#{id}
    </update>
    <!-- 4. 회원 탈퇴 -->
    <delete id="deleteUsers" parameterType="java.lang.String">
        delete users where id=#{id}
    </delete>
    <!-- 5. 비밀번호 변경 -->
    <update id="updatePassword" parameterType="java.util.Map">
        update USERS set password=#{password} where id=#{id} and email=#{email}
    </update>
    <!-- 6. 비밀번호 일치 확인 -->
    <select id="isMatchPassword" parameterType="java.util.Map" resultType="java.lang.Integer">
        select count(*) from USERS where id=#{id} and password=#{password}
    </select>
    <!-- 7. 아이디 중복 체크 -->
    <select id="isExistedId" parameterType="java.lang.String" resultType="java.lang.Integer">
        select count(*) from USERS where id=#{id}
    </select>
    <!-- 8. 이메일, 이름으로 회원 존재여부 확인 -->
    <select id="isExistedUsersByIdEmail" parameterType="java.util.Map" resultType="java.lang.Integer">
        select count(*) from USERS where id=#{id} and email=#{email}
    </select>


</mapper>