<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.weaverloft.ganttchart.mapper.UsersLogMapper">
    <!-- 1. 로그 남기기 -->
    <insert id="createLog" parameterType="java.util.Map">
        <selectKey resultType="java.lang.Integer" keyProperty="logNo" order="BEFORE">
            select USERS_LOG_LOG_NO_SEQ.nextval from DUAL
        </selectKey>
        insert into USERS_LOG(log_no, log_date, log_status,id)
        values (#{logNo},sysdate,#{logStatus},#{id})
    </insert>
    <!-- 2. 로그 전체 수 -->
    <select id="findUsersLogCount">
        select * from USERS_LOG
    </select>
    <!-- 3. 로그리스트 출력 -> 페이징, 검색 -->
    <select id="findUserLog" parameterType="java.util.Map" resultType="com.weaverloft.ganttchart.dto.UsersLog">
        select  *
        from (  select rownum idx, ul.*
                from (  select *
                        from USERS_LOG
                    ) ul
                 where 1=1
                    <if test="keyword !=null">
                        and ul.id like '%'||#{keyword}||'%'
                    </if>
            )
        <![CDATA[ where idx >= #{pageBegin} and idx <= #{pageEnd} ]]>
    </select>


</mapper>