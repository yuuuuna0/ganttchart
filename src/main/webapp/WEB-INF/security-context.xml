<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd">
    <bean class="org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler"/>
    <security:http>
        <security:csrf disabled="true"/>
        <security:intercept-url pattern="/sample/all" access="permitAll"/>
        <security:intercept-url pattern="/sample/member" access="hasRole('ROLE_MEMBER')"/>
        <security:intercept-url pattern="/sample/admin" access="hasRole('ROLE_ADMIN')"/>
        <security:form-login login-page="/customLogin" authentication-success-handler-ref="customLoginSuccess"/>
        <security:access-denied-handler ref="customAccessDenied" />
        <security:logout logout-url="/customLogout" invalidate-session="true"/>
    </security:http>

    <bean id="customAccessDenied" class="com.weaverloft.ganttchart.security.CustomAccessDeniedHandler"/>
    <bean id="customLoginSuccess" class="com.weaverloft.ganttchart.security.CustomLoginSuccessHandler"/>
    <bean id="customPasswordEncoder" class="com.weaverloft.ganttchart.security.CustomPasswordEncoder"/>
<!--    &lt;!&ndash; 단순한 문자열만들 사용하는 -> 표현식을 사용하지 않는 경우 &ndash;&gt;-->
<!--    <security:http auto-config="true" use-expressions="false">-->
<!--        <security:intercept-url pattern="/sample/user" access="ROLE_MEMBER"/>-->
<!--        <security:intercept-url pattern="/sample/puser" access="ROLE_MEMBER"/>-->
<!--        <security:form-login/>-->
<!--        <security:access-denied-handler error-page="/accessError"/>-->
<!--    </security:http>-->

    <security:authentication-manager>
        <security:authentication-provider>
            <security:password-encoder ref="customPasswordEncoder"/>
        </security:authentication-provider>
    </security:authentication-manager>


<!--    &lt;!&ndash; 보안 미적용 &ndash;&gt;-->
<!--    <security:http pattern="/**/*" security="none" />-->

<!--    <security:http auto-config="true" use-expressions="true">-->
<!--        <security:csrf disabled="true"/>-->
<!--&lt;!&ndash;        누구나&ndash;&gt;-->
<!--        <security:intercept-url pattern="/*" access="permitAll"/>-->
<!--&lt;!&ndash;        USER만&ndash;&gt;-->
<!--        <security:intercept-url pattern="/boardWrite" access="hasRole('ROLE_USER')"/>-->
<!--        <security:intercept-url pattern="/myPage" access="hasRole('ROLE_USER')"/>-->
<!--        <security:intercept-url pattern="/emailAuth" access="hasRole('ROLE_USER')"/>-->
<!--        <security:intercept-url pattern="/findId" access="hasRole('ROLE_USER')"/>-->
<!--        <security:intercept-url pattern="/findPassword" access="hasRole('ROLE_USER')"/>-->
<!--        <security:intercept-url pattern="/modify" access="hasRole('ROLE_USER')"/>-->
<!--&lt;!&ndash;        ADMIN 권한&ndash;&gt;-->
<!--        <security:intercept-url pattern="/admin/**" access="hasRole('ROLE_ADMIN')"/>-->
<!--&lt;!&ndash;        로그인&로그아웃 상세 ==> default-target-url:로그인 성공시 이동할 사이트 &ndash;&gt;-->
<!--        <security:form-login login-page="/login" default-target-url="/" username-parameter="id" password-parameter="password"/>-->
<!--        <security:logout logout-url="/*" logout-success-url="/logout-action"/>-->
<!--        <security:access-denied-handler ref="customAccessDenied" />-->
<!--    </security:http>-->
<!--    <bean id="customAccessDenied" class="com.weaverloft.ganttchart.security.CustomAccessDeniedHandler"/>-->
<!--&lt;!&ndash;    데이터베이스 연결&ndash;&gt;-->
<!--    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">-->
<!--        <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver" />-->
<!--        <property name="url" value="jdbc:oracle:thin:@localhost:1521:XE" />-->
<!--        <property name="username" value="c##gantt" />-->
<!--        <property name="password" value="1234" />-->
<!--    </bean>-->
<!--&lt;!&ndash;    사용자 세부 계정 서비스&ndash;&gt;-->
<!--    <bean id="userDetailsService" class="org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl">-->
<!--        <property name="dataSource" ref="dataSource" />-->
<!--        <property name="usersByUsernameQuery" value="select id,password,grade from users where id = ?" />-->
<!--        <property name="authoritiesByUsernameQuery" value="select id,grade from users where id = ?" />-->
<!--    </bean>-->
<!--&lt;!&ndash;    Provider&ndash;&gt;-->
<!--    <security:authentication-manager>-->
<!--        <security:authentication-provider user-service-ref="userDetailsService">-->
<!--&lt;!&ndash;            <security:user-service>&ndash;&gt;-->
<!--&lt;!&ndash;                <security:user name="user" password="{noop}password" authorities="ROLE_USER"/>&ndash;&gt;-->
<!--&lt;!&ndash;                <security:user name="admin" password="{noop}password" authorities="ROLE_USER,ROLE_ADMIN"/>&ndash;&gt;-->
<!--&lt;!&ndash;            </security:user-service>&ndash;&gt;-->
<!--        </security:authentication-provider>-->
<!--    </security:authentication-manager>-->

</beans>